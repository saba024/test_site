(self.webpackChunkmp_webgl=self.webpackChunkmp_webgl||[]).push([[414],{37721:(t,e,i)=>{"use strict";i.d(e,{U:()=>s});class s{constructor(t){this.map=new Map,t.forEach((t=>this.map.set(t.state,t.subs)))}renew(t){(this.map.get(t)||[]).forEach((t=>t.renew()))}cancel(t){if(t){(this.map.get(t)||[]).forEach((t=>t.cancel()))}else this.map.forEach((t=>t.forEach((t=>t.cancel()))))}update(t,e){this.map.set(t,e)}}},38613:(t,e,i)=>{"use strict";i.d(e,{h:()=>a});var s=i(67294);function a(t,e,i){const[a,o]=(0,s.useState)(null===t?i:t[e]);return(0,s.useEffect)((()=>{if(null===t)return;const i=t.onPropertyChanged(e,(t=>{o(t)}));return()=>i.cancel()}),[t,e,i]),a}},7742:(t,e,i)=>{"use strict";i.d(e,{M:()=>l,n:()=>n});var s=i(81396),a=i(89557),o=i(96139),r=i(99623);const n={OpacityMaxDefault:1,OpacityMaxNonSelected:.4};class l extends s.Object3D{constructor(t){super(),this.text=t,this.maxOpacity=1,this.labelAnim=new a.z(0),this.filtered=!1,this.hidden=!1,this.selectState={active:!1,on:()=>{},off:()=>{}},this.validState={active:!0,on:()=>{const t=this.hoverState.active?r.BV.ColorHovered:r.BV.ColorDefault;this.text.setColor(t)},off:()=>{this.text.setColor(r.BV.ColorInvalid)}},this.hoverState={active:!1,on:()=>{this.validState.active&&this.text.setColor(r.BV.ColorHovered)},off:()=>{this.validState.active&&this.text.setColor(r.BV.ColorDefault)}},this.add(t)}use(t){this.data=t,this.userData.sid=t.sid,this.userData.data=t,this.text.use(this),this.labelUpdate(t.position,new s.Quaternion,"")}getId(){return this.data.sid}labelVisible(){return!this.filtered&&!this.hidden}updatePose(t,e){return this.labelUpdate(t,e,this.data.text),this}setMaxOpacity(t){this.maxOpacity=t,this.toggleLabel(this.labelVisible())}free(){this.labelAnim.value>0&&this.toggleLabel(!1)}tickAnimations(t){return this.animateLabelOpacity(.5*t),this}toggleLabel(t){this.hidden=!t,this.updateOpacity()}isHidden(){return this.hidden}toggleFiltered(t){t!==this.filtered&&(this.filtered=t,this.updateOpacity())}updateOpacity(){const t=this.labelVisible()?this.maxOpacity:0;this.labelAnim.endValue!==t&&this.labelAnim.modifyAnimation(this.labelAnim.value,t,o.R.FADE_DURATION)}animateLabelOpacity(t){const e=this.labelAnim.tick(t);Math.min(e,this.maxOpacity)!==this.text.opacity&&(this.text.opacity=e)}labelUpdate(t,e,i){this.text.position.copy(t),this.text.quaternion.copy(e),this.text.text=i}billboard(t,e,i,s,a,o,r){this.text.scaleBillboard(t,e,i,s,a,o,r)}}},99623:(t,e,i)=>{"use strict";i.d(e,{BV:()=>o,Es:()=>n,b6:()=>r});var s=i(67971),a=i(81396);const o={ColorDefault:16777215,ColorHovered:i(15462).I.MP_BRAND.getHex(),ColorInvalid:16750933};class r extends s.$7{use(t){this.userData.sid=t.data.sid,this.collider.data=t.data,this.collider.name=t.data.text,this.collider.labelMesh=t}}class n extends a.Mesh{constructor(){super(...arguments),this.hitTest=(()=>{const t=new a.Matrix4,e=new a.Ray,i=new a.Plane(new a.Vector3(0,0,-1)),s=new a.Vector3;return(a,o)=>{if(t.copy(this.matrixWorld).invert(),e.copy(a.ray).applyMatrix4(t),e.intersectPlane(i,s)){const t=this.scale.x/this.scale.y;let e=.5;t<1.5&&(e=1/t),Math.abs(s.x)<=e&&Math.abs(s.y)<=.75&&(s.applyMatrix4(this.matrixWorld),o.push({distance:a.ray.origin.distanceTo(s),point:s.clone(),object:this}))}}})()}labelVisible(){return!(!this.labelMesh||!this.labelMesh.labelVisible())}getId(){if(!this.data)throw new Error("LabelInputCollider used before configure");return this.data.sid}raycast(t,e){if(!this.labelVisible())return;if(this.material.depthTest)return void this.hitTest(t,e);const i=this.material.depthTest?e:[];this.hitTest(t,i),i.length>0&&(i[0].distance/=1e4,e.push(i[0]))}}},96139:(t,e,i)=>{"use strict";i.d(e,{R:()=>a,_:()=>s});const s=30,a={LABEL_SIZE:0,FADE_DURATION:200}},63792:(t,e,i)=>{"use strict";i.d(e,{B:()=>s,S:()=>n});var s,a=i(81396),o=i(10840),r=i(12529);!function(t){t[t.PIXELS=0]="PIXELS",t[t.METERS=1]="METERS"}(s||(s={}));class n extends a.Mesh{constructor(t,e,i){const n=new Float32Array([-9999,-9999,-9999,9999,9999,9999,-9999,-9999,-9999,9999,9999,9999,9999,9999,9999,-9999,-9999,-9999]),l=new Float32Array([1,1,0,0,-1,-1]),c=new Float32Array([0,1,0,1,0,1]),h=new a.BufferGeometry;h.setAttribute("position",new a.Float32BufferAttribute(n,3)),h.setAttribute("offsetDirection",new a.Float32BufferAttribute(l,1)),h.setAttribute("t",new a.Float32BufferAttribute(c,1)),h.setIndex([0,2,1,2,3,1,2,4,3,4,5,3]);let d={},u={};(null==i?void 0:i.dashUnits)===s.METERS&&(d={WORLDSPACE_DASH:!0},u={derivatives:!0});super(h,new a.RawShaderMaterial({uniforms:a.UniformsUtils.clone(o.T.screenline.uniforms),side:a.FrontSide,vertexShader:o.T.screenline.vertexShader,fragmentShader:o.T.screenline.fragmentShader,transparent:!0,depthTest:i.depthTest,depthWrite:i.depthWrite,depthFunc:i.depthFunc,defines:d,extensions:u})),this.updateEndpoints(t,e),this.geometry.computeBoundingBox(),this.geometry.computeBoundingSphere(),this.renderOrder=r.z.lines,this.onBeforeRender=t=>{t.getSize(this.material.uniforms.screenSize.value)},this.material.uniforms.dashed.value=+i.dashed,this.material.uniforms.dashSize.value=i.dashSize,this.material.uniforms.gapSize.value=i.gapSize,this.material.uniforms.lineWidth.value=i.lineWidth,this.material.uniforms.color.value.copy(i.color),this.material.uniforms.opacity.value=i.opacity}updateEndpoints(t,e){this.material.uniforms.start.value.copy(t),this.material.uniforms.end.value.copy(e)}opacity(t){this.material.uniforms.opacity.value=t}color(t){this.material.uniforms.color.value.copy(t)}}},27990:(t,e,i)=>{"use strict";i.d(e,{Ko:()=>h,hJ:()=>u});var s=i(81396),a=i(69505),o=i(59370);const r=new s.Vector2,n=new s.Vector3,l=new s.Vector2,c=new s.Vector2,h=(t,e,i)=>{const s=((t,e,i)=>((0,o.q9)(i,t,l),(0,o.q9)(i,e,c),{pixelDistance:l.distanceTo(c),startScreenPosition:l,endScreenPosition:c}))(t,e,i);return{screenPosition:((t,e,i)=>(n.copy(t).add(e).multiplyScalar(.5),(0,o.q9)(i,n,r),r))(t,e,i),rotation:d(l,c),pixelDistance:s.pixelDistance,startScreenPosition:s.startScreenPosition,endScreenPosition:s.endScreenPosition}},d=(t,e)=>{const i=t.y-e.y,s=t.x-e.x;let o=Math.atan2(i,s)*a.MN;return o=o>=90||o<=-90?o+180:o,o},u=(t,e=10,i=40)=>({width:Math.max(9*Math.max(t,2)+e,i),height:18+e})},26269:(t,e,i)=>{"use strict";i.d(e,{$4:()=>o,oR:()=>a});var s=i(7402);const a=t=>!!t&&t instanceof s.g,o={hasMeshGroup:t=>"object"==typeof t&&!!t&&"meshGroup"in t,hasMeshSubgroup:t=>"object"==typeof t&&!!t&&"meshSubgroup"in t,isRoomMesh:a,isVisibleRoomMesh:t=>a(t)&&t.raycastEnabled&&t.visible}},88338:(t,e,i)=>{"use strict";i.d(e,{E:()=>s});const s={longerTransitionMaxDist:10,TRANSITION_TIME_DH:650,TRANSITION_TIME_ROOM:800}},20043:(t,e,i)=>{"use strict";i.d(e,{Gs:()=>l,Tq:()=>c,bG:()=>d});var s=i(98169),a=i(81248),o=i(88338);if(984==i.j)var r=i(35895);if(984==i.j)var n=i(12039);function l(t){return(0,r.k1)((()=>t(new n.ZK)),(()=>t(new n.Lp)),!1)}const c=(t,e,i,s,...a)=>h({sweepData:t,direction:e,directionFactor:i,sourceSweep:s,ignoreSweeps:a}),h=t=>{const{sweepData:e,direction:i,sourceSweep:o,ignoreSweeps:r,directionFactor:n}=t;if(!e.currentSweepObject)return[];const l=o||e.currentSweepObject,c=[s.ff(l),s._k(),s.vO(l),s.pI(l.position,i,n)];for(const t of r)c.push(s.ff(t));const h=[a.o7(l.position,i),a.TE(l.position)],d=e.getSweepNeighbours(l);return e.sortByScore(c,h,d)},d=(t,e,i,r)=>{const n=[s._k(),s._T()],l=[a.Dv(i.point)],c=t.currentSweepObject;e&&c&&n.push(s.ff(c),s.SF(c.position,o.E.longerTransitionMaxDist),s.vO(c)),i.face&&n.push(s.D5(i.point,i.face.normal));const h=r.floorIdFromObject(i.object);h&&l.push(a.Bv(h));const d=t.sortByScore(n,l);if(0===d.length){const e=t.getClosestSweep(i.point,!0);d.push({sweep:e,score:0})}return d}},1305:(t,e,i)=>{"use strict";i.d(e,{E:()=>m});var s=i(15462),a=i(19098),o=i(93411),r=i(67944),n=i(23885),l=i(81396),c=i(25869),h=i(89392),d=i(82403),u=i(3297);const p={baseState:{innerColor:s.I.WHITE,outerColor:s.I.WHITE,opacity:1},hoverState:{innerColor:s.I.WHITE,outerColor:s.I.NEPTUNE,opacity:1},selectState:{innerColor:s.I.WHITE,outerColor:s.I.NEPTUNE,opacity:1},dimState:{innerColor:s.I.WHITE,outerColor:s.I.WHITE,opacity:.5},highlightState:{innerColor:s.I.WHITE,outerColor:s.I.NEPTUNE,opacity:1}};class m extends h.H{constructor(t,e,i,h){const m=new Float32Array([0,0,0,1,0,0,1,0,1,0,0,1,-1,0,1,-1,0,0,1,0,2,-1,0,2,-1,0,-1,1,0,-1]),f=new l.BufferGeometry;f.setAttribute("position",new l.Float32BufferAttribute(m,3)),f.setIndex([0,1,2,0,2,3,0,3,4,0,4,5,3,2,6,3,7,4,0,9,1,0,5,8]);const v=new l.RawShaderMaterial({uniforms:l.UniformsUtils.clone(u.LD.uniforms),vertexShader:u.LD.vertexShader,fragmentShader:u.LD.fragmentShader,transparent:!0,depthTest:!1,stencilRef:65535,stencilFuncMask:1<<c.$.OPENINGS,stencilFail:l.KeepStencilOp,stencilZFail:l.KeepStencilOp,stencilZPass:l.KeepStencilOp,stencilFunc:l.GreaterStencilFunc,stencilWrite:!0,extensions:{derivatives:!0}});super(t,f,v,e),this.lineLabel=i,this.isAddState=h,this.line3=new l.Line3(new l.Vector3,new l.Vector3),this.widthCache=.1,this.updateMaterial=()=>{super.updateMaterial(),this.targetColorScheme!==p.highlightState||this.isAddState()||(this.targetColorScheme=p.baseState);const t=this.material.uniforms;this.prevColorState.innerColor.copy(t.color.value),this.prevColorState.outerColor.copy(t.outlineColor.value),this.prevColorState.opacity=t.opacity.value;const e=this.selectState.active||this.highlightState.active,i=this.hoverState.active;this.renderOrder=e||i?c.o.HIGHLIGHTED_EDGE:c.o.EDGE,this.animation.modifyAnimation(0,1,d.rP,n.hl),this.lineLabel.setVisible(this.selectState.active||this.highlightState.active||this.hoverState.active)},this.raycast=(()=>{const t=new l.Vector3,e=new l.Vector2,i=new l.Vector2;return(s,a)=>{const o=this.line3.closestPointToPoint(s.ray.origin,!0,t);e.set(o.x,o.z),i.set(s.ray.origin.x,s.ray.origin.z);const n=e.distanceTo(i),c=s.ray.origin.distanceTo(this.line3.start),h=(0,r._U)(c,this.cameraData.pose.projection.asThreeMatrix4(),this.cameraData.width),u=d.Nh*h;n<.5*Math.max(this.widthCache,d.ZT)+u&&a.push({distance:c,object:this,point:o.clone(),face:{a:-1,b:-1,c:-1,materialIndex:-1,normal:new l.Vector3(0,1,0)}})}})(),this.onEdgePositionChanged=(()=>{const t=new l.Vector3,e=new l.Vector3,i=new l.Vector3,s=new l.Vector3,o=new l.Vector3,r=new l.Vector3,n=new l.Vector3;return(l,c,h)=>{const d=l.getWall(this.roomBoundsId);d.from.getVec3(t),d.to.getVec3(e);const u=this.geometry.getAttribute("position");d.getBiasAdjustmentVec(n),i.set(t.x,t.y+c,t.z),s.set(e.x,e.y+c,e.z),o.addVectors(i,n),r.addVectors(s,n),this.line3.start.copy(o),this.line3.end.copy(r),this.material.uniforms.lineStart.value.copy(o),this.material.uniforms.lineEnd.value.copy(r),this.material.uniforms.width.value=d.width,this.stencilMat.uniforms.lineStart.value.copy(o),this.stencilMat.uniforms.lineEnd.value.copy(r),this.stencilMat.uniforms.width.value=d.width,this.widthCache=d.width,this.lineLabel.updateDimensions(o,r,d.width,h),u.setXYZ(0,i.x,i.y,i.z),u.setXYZ(3,s.x,s.y,s.z);const{fromLeft:p,fromRight:m,toLeft:f,toRight:v}=(0,a.b)(d,l);u.setXYZ(1,m.primary.x,m.primary.y+c,m.primary.z),u.setXYZ(2,v.primary.x,v.primary.y+c,v.primary.z),u.setXYZ(4,f.primary.x,f.primary.y+c,f.primary.z),u.setXYZ(5,p.primary.x,p.primary.y+c,p.primary.z),u.setXYZ(9,m.bevel.x,m.bevel.y+c,m.bevel.z),u.setXYZ(6,v.bevel.x,v.bevel.y+c,v.bevel.z),u.setXYZ(7,f.bevel.x,f.bevel.y+c,f.bevel.z),u.setXYZ(8,p.bevel.x,p.bevel.y+c,p.bevel.z),u.needsUpdate=!0,this.geometry.computeBoundingBox(),this.geometry.computeBoundingSphere()}})(),this.renderOrder=c.o.EDGE,this.geometry.computeBoundingBox(),this.geometry.computeBoundingSphere(),this.colors=p,this.material.uniforms.selectedWidth.value=.03;const g=v.clone();g.stencilRef=65535,g.stencilFuncMask=1<<c.$.OPENINGS,g.stencilWriteMask=1<<c.$.EDGE,g.stencilFail=l.KeepStencilOp,g.stencilZFail=l.KeepStencilOp,g.stencilZPass=l.ReplaceStencilOp,g.stencilFunc=l.AlwaysStencilFunc,g.stencilWrite=!0,g.colorWrite=!1,this.stencilMat=g;const b=new l.Mesh(this.geometry,this.stencilMat);b.renderOrder=c.o.EDGE_STENCIL,this.stencilMesh=b;const y=s.I.WHITE.clone();this.animation.onChanged((()=>{const t=this.prevColorState,e=this.targetColorScheme;this.material.uniforms.outlineColor.value.lerpColors(t.outerColor,e.outerColor,this.animation.value);this.material.uniforms.color.value.lerpColors(t.innerColor,e.innerColor,this.animation.value);const i=(0,o.t)(t.opacity,e.opacity,this.animation.value);this.opacity=i,y.copy(s.I.WHITE).multiplyScalar(this.opacity)})),this.onBeforeRender=()=>{this.material.depthTest=1===this.pitchFactor,this.material.uniforms.opacity.value=(1-this.pitchFactor)*this.opacity,this.lineLabel.update()}}tickAnimations(t){super.tickAnimations(t),this.lineLabel.tickAnimations(t)}setLabelVisible(t){this.lineLabel.setVisible(t)}dispose(){super.dispose(),this.lineLabel.dispose()}}},47626:(t,e,i)=>{"use strict";i.d(e,{G:()=>m});var s=i(81396),a=i(25869),o=i(89392),r=i(15462),n=i(3297),l=i(93411),c=i(23885),h=i(82403),d=i(67944);const u={baseState:{opacity:1,innerColor:r.I.MIRROR,outerColor:r.I.PORTAL},hoverState:{opacity:1,innerColor:r.I.MIRROR,outerColor:r.I.PORTAL},selectState:{opacity:1,innerColor:r.I.MP_BRAND,outerColor:r.I.WHITE},dimState:{opacity:1,innerColor:r.I.MIRROR,outerColor:r.I.PORTAL}};class p extends s.RawShaderMaterial{constructor(){super({fragmentShader:n.pr.fragmentShader,vertexShader:n.pr.vertexShader,uniforms:s.UniformsUtils.clone(n.pr.uniforms),name:"HandleMaterial",transparent:!0,depthTest:!1,extensions:{derivatives:!0}})}}class m extends o.H{constructor(t,e){const i=new Float32Array([-1,0,-1,1,0,-1,1,0,1,-1,0,1]),o=new s.BufferGeometry;o.setAttribute("position",new s.Float32BufferAttribute(i,3)),o.setIndex([0,2,1,0,3,2]),super(t,o,new p,e),this.targetRadius=.3,this.prevRadius=.3,this.renderOrder=a.o.NODE,this.colors=u,this.animation.onChanged((()=>this.onAnimationChange())),this.onBeforeRender=()=>{this.material.uniforms.opacity.value=this.opacity*(1-this.pitchFactor)}}onAnimationChange(){const t=this.prevColorState,e=this.targetColorScheme;this.material.uniforms.outlineColor.value.lerpColors(t.outerColor,e.outerColor,this.animation.value),this.material.uniforms.baseColor.value.lerpColors(t.innerColor,e.innerColor,this.animation.value),this.opacity=(0,l.t)(t.opacity,e.opacity,this.animation.value);const i=(0,l.t)(this.prevRadius,this.targetRadius,this.animation.value);this.setRadius(i)}setPitchFactor(t){super.setPitchFactor(t),this.visible=this.pitchFactor<1}raycast(t,e){const i=[];if(super.raycast(t,i),i.length>0){const s=i[0].point,a=t.ray.origin.distanceTo(this.position),o=(0,d._U)(a,this.cameraData.pose.projection.asThreeMatrix4(),this.cameraData.width),r=h.Nh*o;s.distanceTo(this.position)<h.pp+r&&e.push(i[0])}}updateMaterial(){this.prevRadius=this.material.uniforms.radius.value,this.targetRadius=h.pp+(this.hoverState.active?h.XG:0)+(this.selectState.active?h.XG:0),super.updateMaterial(),this.prevColorState.innerColor.copy(this.material.uniforms.baseColor.value),this.prevColorState.outerColor.copy(this.material.uniforms.outlineColor.value),this.prevColorState.opacity=this.material.opacity,this.animation.modifyAnimation(0,1,h.rP,c.hl)}setRadius(t){this.material.uniforms.radius.value=t}updatePosition(t){this.position.copy(t)}}},98120:(t,e,i)=>{"use strict";i.d(e,{EK:()=>b,ch:()=>f,jr:()=>y,pG:()=>g});var s=i(15462),a=i(23885),o=i(81396),r=i(47626),n=i(25869),l=i(89392),c=i(3297),h=i(80978),d=i(82403);class u extends o.RawShaderMaterial{constructor(){super({fragmentShader:c.z6.fragmentShader,vertexShader:c.z6.vertexShader,uniforms:o.UniformsUtils.clone(c.z6.uniforms),name:"OpeningMaterial",depthTest:!1,transparent:!0,stencilFunc:o.AlwaysStencilFunc,stencilWrite:!1})}}const p=new o.BoxGeometry(1,1,1);class m extends l.H{constructor(t,e,i){super(t,p.clone(),new u,i),this.floorId=e,this.onEdgePositionChanged=(()=>{const t=new o.Vector3;return(e,i,s,a)=>{t.subVectors(i,e),this.scale.set(t.length(),.05,s),this.stencilPrepass&&this.stencilPrepass.scale.set(t.length(),.05,s);const o=Math.atan2(i.x-e.x,i.z-e.z)+Math.PI/2;this.rotation.y=o,this.stencilPrepass&&(this.stencilPrepass.rotation.y=o);const r=t.addVectors(i,e).multiplyScalar(.5);this.position.copy(r),this.stencilPrepass&&this.stencilPrepass.position.copy(r),this.startHandle.position.copy(e),this.endHandle.position.copy(i);const n=a===h.u.DOOR?1:0;this.material.uniforms.isDoor.value=n,this.stencilPrepass&&(this.stencilPrepass.material.uniforms.isDoor.value=n)}})(),this.renderOrder=n.o.OPENING_LINES,this.startHandle=new b(t,i,this),this.endHandle=new y(t,i,this),this.animation.onChanged((()=>{this.material.uniforms.baseColor.value.lerpColors(s.I.WHITE,s.I.NEPTUNE,this.animation.value)}))}setPitchFactor(t){super.setPitchFactor(t),this.visible=this.pitchFactor<1,this.startHandle.setPitchFactor(t),this.endHandle.setPitchFactor(t),this.stencilPrepass&&this.stencilPrepass.setPitchFactor(t)}updateMaterial(){const t=this.selectState.active||this.hoverState.active||this.highlightState.active;this.animation.modifyAnimation(this.animation.value,t?1:0,d.rP,a.hl)}tickAnimations(t){super.tickAnimations(t),this.startHandle.tickAnimations(t),this.endHandle.tickAnimations(t)}}class f extends m{constructor(t,e,i){super(t,e,i),this.floorId=e,this.stencilPrepass=new v(t,e,i)}}class v extends m{constructor(t,e,i){super(t,e,i),this.floorId=e,this.renderOrder=n.o.OPENING_STENCIL,this.material.colorWrite=!1,this.material.stencilRef=65535,this.material.stencilFuncMask=1<<n.$.OPENINGS,this.material.stencilWriteMask=1<<n.$.OPENINGS,this.material.stencilFail=o.ReplaceStencilOp,this.material.stencilZFail=o.ReplaceStencilOp,this.material.stencilZPass=o.ReplaceStencilOp,this.material.stencilFunc=o.AlwaysStencilFunc,this.material.stencilWrite=!0}raycast(t,e){}}class g extends r.G{constructor(t,e,i){super(t,e),this.parentOpeningView=i}}class b extends g{}class y extends g{}},25869:(t,e,i)=>{"use strict";i.d(e,{$:()=>a,o:()=>s});var s,a,o=i(12529);!function(t){t[t.BASE=o.z.roomBounds]="BASE",t[t.OPENING_STENCIL=o.z.roomBounds+1]="OPENING_STENCIL",t[t.EDGE_STENCIL=o.z.roomBounds+2]="EDGE_STENCIL",t[t.ROOM=o.z.roomBounds+3]="ROOM",t[t.EDGE=o.z.roomBounds+4]="EDGE",t[t.HIGHLIGHTED_EDGE=o.z.roomBounds+5]="HIGHLIGHTED_EDGE",t[t.OPENING_LINES=o.z.roomBounds+6]="OPENING_LINES",t[t.NODE=o.z.roomBounds+7]="NODE"}(s||(s={})),function(t){t[t.OPENINGS=0]="OPENINGS",t[t.EDGE=1]="EDGE"}(a||(a={}))},87732:(t,e,i)=>{"use strict";i.d(e,{c:()=>w});var s=i(15462),a=i(27990),o=i(93411),r=i(69505),n=i(67944),l=i(23885);function c(t,e,i){const s=function(t){return t/180*Math.PI}(e||0);if(!i||0===i[0]&&0===i[1])return h(t,s);return h(t.map(((t,e)=>t-i[e])),s).map(((t,e)=>t+i[e]))}function h(t,e){return[t[0]*Math.cos(e)-t[1]*Math.sin(e),t[0]*Math.sin(e)+t[1]*Math.cos(e)]}function d(t,e,i){let s=[];for(let a=0,o=t.length;a<o;a++)s[a]=c(t[a],e,i);return s}var u=i(65661),p=i(81396),m=i(25869),f=i(89392),v=i(82403),g=i(3297);class b extends p.Mesh{constructor(t,e,i){const s=new Float32Array([-1,0,-1,1,1,1,1,0]),a=new Float32Array([0,1,0,0,1,0,0,1,0,0,1,0]),o=new p.BufferGeometry;o.setAttribute("offset",new p.Float32BufferAttribute(s,2)),o.setAttribute("normal",new p.Float32BufferAttribute(a,3)),o.setIndex([0,3,1,3,2,1]);super(o,new p.RawShaderMaterial({uniforms:p.UniformsUtils.clone(g.Ud.uniforms),vertexShader:g.Ud.vertexShader,fragmentShader:g.Ud.fragmentShader,side:p.FrontSide,transparent:!0,depthTest:!1})),this.updateState(t,e,i),this.renderOrder=m.o.EDGE,this.frustumCulled=!1,this.onBeforeRender=t=>{t.getSize(this.material.uniforms.screenSize.value)}}updateState(t,e,i){this.material.uniforms.tip.value.copy(t),this.material.uniforms.normal.value.copy(e),this.material.uniforms.height.value=i}updateOpacity(t){this.material.uniforms.opacity.value=t}updateMetersPerPx(t){this.material.uniforms.metersPerPx.value=t}raycast(t){}}var y=i(69877),S=i(63792),x=i(59370),E=i(59279),M=i(28941);const C={baseState:{innerColor:s.I.LENS_GRAY,outerColor:s.I.WHITE,opacity:0},hoverState:{innerColor:s.I.WHITE,outerColor:s.I.WHITE,opacity:.25},selectState:{innerColor:s.I.NEPTUNE,outerColor:s.I.WHITE,opacity:0},dimState:{innerColor:s.I.LENS_GRAY,outerColor:s.I.WHITE,opacity:.5}};class w extends f.H{constructor(t,e,i,r,l,c){const h=w.getGeoFromRoom(t,e),d=new p.MeshBasicMaterial({color:s.I.LENS_GRAY,depthTest:!1,side:p.DoubleSide,transparent:!0,opacity:0,blending:p.NormalBlending,blendEquation:p.AddEquation,blendSrc:p.SrcAlphaFactor,blendDst:p.DstColorFactor,stencilRef:65535,stencilFuncMask:1<<m.$.EDGE,stencilFail:p.KeepStencilOp,stencilZFail:p.KeepStencilOp,stencilZPass:p.KeepStencilOp,stencilFunc:p.GreaterStencilFunc,stencilWrite:!0});super(t.id,h,d,i),this.baseHeight=e,this.labelManager=r,this.units=l,this.showInPerspective=c,this.potentialLabels=[],this.perimeterLabels=[],this.dimensionCarets=[new b(new p.Vector2,new p.Vector2,0),new b(new p.Vector2,new p.Vector2,0),new b(new p.Vector2,new p.Vector2,0),new b(new p.Vector2,new p.Vector2,0)],this.hideMaterial=new p.RawShaderMaterial({vertexShader:g.AK.vertexShader,fragmentShader:g.AK.fragmentShader,uniforms:p.UniformsUtils.clone(g.AK.uniforms),depthTest:!1,side:p.DoubleSide,transparent:!0}),this.perimeterLabelsVisible=!1,this.fullLabelVisible=!1,this.hoverTimer=null,this.labelHovered=!1,this.heightLines=new p.Group,this.heightLabels=[],this.intersectionPriority=M.e.Labels,this.getLabelPolygon=(()=>{const t=new p.Vector3,e=[0,0],i=[e,[0,0],[0,0],[0,0],e];return(e,s)=>{const o=this.cameraData.pose.position.distanceTo(s),r=(0,n._U)(o,this.cameraData.pose.projection.asThreeMatrix4(),this.cameraData.width),l=e.split("\n"),c=l.reduce(((t,e)=>Math.max(t,e.length)),0),h=(0,a.hJ)(c,0,0),d=s.x,u=s.z,p=.5*h.width*r,m=.5*h.height*r*l.length;return t.set(d-p,0,u-m),t.applyQuaternion(this.cameraData.pose.rotation),i[0][0]=d-p,i[0][1]=u-m,i[1][0]=d+p,i[1][1]=u-m,i[2][0]=d+p,i[2][1]=u+m,i[3][0]=d-p,i[3][1]=u+m,i}})(),this.standardMaterial=d,this.renderOrder=m.o.ROOM,this.roomLabel=this.labelManager.createRoomLabel(t.floorId,t.id),this.roomLabel.addTo(this),this.roomLabel.setVisible(!t.hide),this.room=t;for(const t of this.dimensionCarets)this.add(t);this.updateLabel(!0),this.colors=C,this.animation.onChanged((()=>{const t=this.prevColorState;this.standardMaterial.color.lerpColors(t.innerColor,this.targetColorScheme.innerColor,this.animation.value);const e=(0,o.t)(t.opacity,this.targetColorScheme.opacity,this.animation.value);this.opacity=e,this.hideMaterial.uniforms.opacity.value=this.roomLabel.label.opacity})),this.onBeforeRender=()=>{this.standardMaterial.opacity=this.opacity*(1-this.pitchFactor);const t=this.dimState.active?.5:1;for(const e of this.dimensionCarets)e.updateMetersPerPx(i.metersPerPx()),e.updateOpacity((1-this.pitchFactor)*t)},this.add(this.heightLines)}dispose(){this.labelManager.deleteLabel(this.roomLabel);for(const t of this.perimeterLabels)this.labelManager.deleteLabel(t),t.dispose();this.clearHoverTimer(),super.dispose()}hoverRoomLabel(t){const e=()=>{if(!t&&this.roomLabel.getDisplayingTooltip()===t||t&&this.fullLabelVisible)return void(t||(this.labelHovered=!1,this.updateMaterial()));this.roomLabel.setDisplayingTooltip(t),this.updateMaterial();const e=this.roomLabel.label.collider.material;e.opacity=t?.65:0,e.transparent=!0,this.updateLabel(!1),this.updateCarets()};this.labelHovered=t,this.updatePerimeterLabelVisibility(),t?null===this.hoverTimer&&(this.hoverTimer=window.setTimeout(e,v.qb),this.updateMaterial()):(e(),this.clearHoverTimer())}updateGeo(t,e,i){this.room=t,this.baseHeight=e;const s=w.getGeoFromRoom(t,e);this.geometry.dispose(),this.geometry=s,this.geometry.computeBoundingBox(),this.updateLabel(!1),this.units=i,this.perimeterLabelsVisible&&this.updatePerimeterLabels(),this.heightLines.children.length&&this.createHeightObjects()}updateLabelBillboard(){const{position:t,rotation:e,projection:i}=this.cameraData.pose,{height:s}=this.cameraData,a=this.cameraData.isOrtho()?this.cameraData.zoom():1,o=this.cameraData.aspect();this.roomLabel.label.quaternion.copy(e),this.roomLabel.label.scaleBillboard(t,e,i,a,s,o,.1),this.updateLabel(!1);for(const t of this.perimeterLabels)t.update();this.updateMaterial(),this.updateCarets()}updatePerimeterLabelVisibility(){const t=this.hoverState.active||this.labelHovered;this.perimeterLabelsVisible=this.selectState.active||t&&(0,x.Eb)(this.pitchFactor),this.perimeterLabelsVisible&&this.updatePerimeterLabels();for(const t of this.perimeterLabels)t.setVisible(this.perimeterLabelsVisible);this.updateCarets()}updateMaterial(){this.material=this.room.hide?this.hideMaterial:this.standardMaterial,super.updateMaterial();const t=this.hoverState.active||this.labelHovered,e=(0,x.Eb)(this.pitchFactor);e||!this.selectState.active&&!t?this.heightLines.clear():this.heightLines.children.length||this.createHeightObjects(),t&&e&&(this.targetColorScheme=this.colors.hoverState);const i=this.standardMaterial;if(this.prevColorState.innerColor.copy(i.color),this.prevColorState.opacity=i.opacity,this.animation.modifyAnimation(0,1,v.rP,l.hl),this.roomLabel.setDimmed(this.dimState.active),!this.showInPerspective&&this.cameraData.pose.pitchFactor()>.5){this.roomLabel.setVisible(!1);for(const t of this.perimeterLabels)t.setVisible(!1)}else{this.roomLabel.setVisible(!this.room.hide||t);for(const t of this.perimeterLabels)t.setVisible(this.perimeterLabelsVisible)}this.updateHeightLabels(),this.updatePerimeterLabelVisibility()}updateText(t,e){this.potentialLabels=t,this.updateLabel(e),this.updateCarets()}static getGeoFromRoom(t,e){const{points:i,faces:s}=t.getGeometry(),a=i.map((t=>[t.x,e,t.y])).flat(1),o=new p.BufferGeometry;return o.setAttribute("position",new p.BufferAttribute(new Float32Array(a),3)),o.setIndex(s.flat(1)),o}updateLabel(t){if(0===this.potentialLabels.length)return;const e=this.room.points.map((t=>[t.x,t.z]));e.push(e[0]);const i=(new p.Euler).setFromQuaternion(this.cameraData.pose.rotation).z,s=r.MN*i,a=[];if(!t){const{position:t}=this.roomLabel.label,e={x:t.x,y:t.z};this.room.holesCW.find((t=>{const i=t.map((t=>({x:t.x,y:t.z})));return(0,y.L)(e,i)}))||a.push(t.clone())}a.push(this.room.getViewCenter(new p.Vector3,1.5));for(const t of a){this.roomLabel.label.position.copy(t),this.roomLabel.label.position.y=this.baseHeight+v.mU;let i=!1;this.fullLabelVisible=!0;for(const o of this.potentialLabels){const r=d(this.getLabelPolygon(o,t),-s,[t.x,t.z]);if((0,u.D)(r,e)||this.roomLabel.getDisplayingTooltip()||t===a[a.length-1]&&"..."===o){this.roomLabel.label.text=o,i=!0;break}this.fullLabelVisible=!1}if(i)break}}updatePerimeterLabels(){const t=this.room.hide?[]:this.room.minimalInnerLoop;for(;t.length>this.perimeterLabels.length;)this.perimeterLabels.push(this.labelManager.createPerimeterLabel(this.room.floorId).addTo(this));for(;t.length<this.perimeterLabels.length;){const t=this.perimeterLabels.pop();if(!t)throw new Error("Label should exist!");this.labelManager.deleteLabel(t)}for(let e=0;e<t.length;e++){const i=t[e],s=i.start.clone();s.y=this.baseHeight;const a=i.end.clone();a.y=this.baseHeight,this.perimeterLabels[e].updateDimensions(s,a,0,this.units)}}updateCarets(){const t=this.cameraData.metersPerPx(),e=this.room.length/t,i=this.room.width/t,s=this.roomLabel.getSize(),a=s.width+2>e,o=s.height+2>i,r=this.fullLabelVisible&&(a||o);if(!this.room.canDisplayDimensions()||this.perimeterLabelsVisible||!this.fullLabelVisible||r)for(const t of this.dimensionCarets)t.visible=!1;else{const t=new p.Vector2;t.subVectors(this.room.w2,this.room.w1).normalize(),this.dimensionCarets[0].updateState(this.room.w1,t,this.baseHeight),this.dimensionCarets[0].visible=!0,t.subVectors(this.room.w1,this.room.w2).normalize(),this.dimensionCarets[1].updateState(this.room.w2,t,this.baseHeight),this.dimensionCarets[1].visible=!0,t.subVectors(this.room.l2,this.room.l1).normalize(),this.dimensionCarets[2].updateState(this.room.l1,t,this.baseHeight),this.dimensionCarets[2].visible=!0,t.subVectors(this.room.l1,this.room.l2).normalize(),this.dimensionCarets[3].updateState(this.room.l2,t,this.baseHeight),this.dimensionCarets[3].visible=!0}}clearHoverTimer(){null!==this.hoverTimer&&(clearTimeout(this.hoverTimer),this.hoverTimer=null)}createHeightObjects(){this.heightLines.clear();for(const t of this.heightLabels)this.labelManager.deleteLabel(t);this.heightLabels.length=0;const t={dashed:!1,dashSize:1,gapSize:1,lineWidth:(0,E.eY)("rb_linewidth",1),color:s.I.WHITE,dashUnits:S.B.METERS,depthWrite:!1,depthTest:!0,depthFunc:p.LessDepth,opacity:1},e={dashed:!0,dashSize:.08,gapSize:.04,lineWidth:(0,E.eY)("rb_linewidth",1),color:s.I.WHITE,dashUnits:S.B.METERS,depthWrite:!1,depthTest:!0,depthFunc:p.GreaterDepth,opacity:1},i=(i,s)=>{const a=new S.S(i,s,e),o=new S.S(i,s,t);this.heightLines.add(o),this.heightLines.add(a)},a=new p.Vector3,o=new p.Vector3,r=this.room.getInnerLoops();for(const t of r){const e=t.length;for(let s=0;s<e;s++){const r=this.labelManager.createPerimeterLabel(this.room.floorId);a.copy(t[s]),a.y=this.baseHeight,o.copy(t[(s+1)%e]),o.y=this.baseHeight,r.updateDimensions(a,o,0,this.units),r.addTo(this),i(a,o),this.room.canDisplayHeight()&&(a.y+=this.room.height,o.y+=this.room.height,i(a,o))}if(this.room.canDisplayHeight())for(const e of t){a.copy(e),a.y=this.baseHeight,o.copy(a),o.y+=this.room.height,i(a,o);const t=this.labelManager.createPerimeterLabel(this.room.floorId);t.labelGroupId=this.room.id,t.updateDimensions(a,o,0,this.units),t.setVisible(!0),t.addTo(this.heightLines),this.heightLabels.push(t)}}}updateHeightLabels(){const t=this.selectState.active&&!(0,x.Eb)(this.pitchFactor);for(const e of this.heightLabels)e.setVisible(t)}setPitchFactor(t){this.pitchFactor=t,this.raycastEnabled=(0,x.Eb)(this.pitchFactor)||this.showInPerspective}}},89392:(t,e,i)=>{"use strict";i.d(e,{H:()=>n});var s=i(59370),a=i(89557),o=i(81396),r=i(25869);class n extends o.Mesh{constructor(t,e,i,s){super(e,i),this.roomBoundsId=t,this.cameraData=s,this.animation=new a.z(0),this.prevColorState={opacity:1,innerColor:new o.Color,outerColor:new o.Color},this.pitchFactor=1,this.raycastEnabled=!0,this.opacity=1,this.selectState={active:!1,on:()=>{this.updateMaterial()},off:()=>{this.updateMaterial()}},this.hoverState={active:!1,on:()=>{this.updateMaterial()},off:()=>this.updateMaterial()},this.highlightState={active:!1,on:()=>this.updateMaterial(),off:()=>this.updateMaterial()},this.dimState={active:!1,on:()=>this.updateMaterial(),off:()=>this.updateMaterial()},this.name=t,this.renderOrder=r.o.BASE}updateMaterial(){var t;let e=this.colors.baseState;this.dimState.active&&(e=this.colors.dimState),this.hoverState.active&&(e=this.colors.hoverState),this.highlightState.active&&(e=null!==(t=this.colors.highlightState)&&void 0!==t?t:this.colors.selectState),this.selectState.active&&(e=this.colors.selectState);e!==this.targetColorScheme&&(this.targetColorScheme=e)}tickAnimations(t){this.animation.tick(t)}dispose(){}raycast(t,e){if(!this.raycastEnabled)return;const i=[];super.raycast(t,i),i.length>0&&e.push(i[0])}setPitchFactor(t){this.pitchFactor=t,this.raycastEnabled=(0,s.Eb)(this.pitchFactor)}}},82403:(t,e,i)=>{"use strict";i.d(e,{Nh:()=>a,XG:()=>r,ZT:()=>o,bk:()=>l,mU:()=>h,pp:()=>s,qb:()=>c,rP:()=>n});const s=.06,a=7,o=.1,r=.02,n=100,l=8,c=500,h=.9},3297:(t,e,i)=>{"use strict";i.d(e,{AK:()=>P,LD:()=>T,Ud:()=>L,pr:()=>O,z6:()=>I});var s=i(15462),a=i(81396),o=i(67498),r=i.n(o),n=i(73293),l=i.n(n),c=i(40134),h=i.n(c),d=i(93670),u=i.n(d),p=i(86242),m=i.n(p),f=i(14536),v=i.n(f),g=i(47706),b=i.n(g),y=i(72292),S=i.n(y),x=i(25888),E=i.n(x),M=i(73868),C=i.n(M),w=i(82403);const O={uniforms:{outlineColor:{type:"v4",value:s.I.BLACK},baseColor:{type:"v4",value:s.I.SINE},outlinePct:{type:"f",value:.8},radius:{type:"f",value:w.pp},opacity:{type:"f",value:1}},vertexShader:r(),fragmentShader:l()},T={uniforms:{outlineColor:{type:"v3",value:s.I.WHITE},color:{type:"v3",value:s.I.WHITE},lineStart:{type:"v3",value:new a.Vector3},lineEnd:{type:"v3",value:new a.Vector3},width:{type:"f",value:1},selectedWidth:{type:"f",value:.01},opacity:{type:"f",value:1}},vertexShader:h(),fragmentShader:u()},I={uniforms:{baseColor:{type:"v4",value:s.I.WHITE},isDoor:{type:"f",value:1},opacity:{type:"f",value:1}},vertexShader:m(),fragmentShader:v()},P={uniforms:{opacity:{type:"f",value:1},centerSpacing:{type:"f",value:24},radius:{type:"f",value:4},color:{type:"v4",value:s.I.LENS_GRAY}},vertexShader:b(),fragmentShader:S()},L={uniforms:{tip:{type:"v2",value:new a.Vector2},normal:{type:"v2",value:new a.Vector2},height:{type:"f",value:0},color:{type:"v4",value:s.I.WHITE},opacity:{type:"f",value:1},outline:{type:"f",value:1},outlineColor:{type:"v4",value:s.I.BLACK},screenSize:{type:"v2",value:new a.Vector2},paddingPx:{type:"f",value:2},widthPx:{type:"f",value:12},heightPx:{type:"f",value:6},aaPaddingPx:{type:"f",value:2},metersPerPx:{type:"f",value:.01}},vertexShader:E(),fragmentShader:C()}},69614:(t,e,i)=>{"use strict";i.d(e,{Y:()=>n});var s=i(32683),a=i(16747),o=i(10513),r=i(55248);class n{constructor(t,e){this.editor=t,this.data=e,this.readBindings=[],this.mover={onMove:(t,e)=>{}},this.onCurrentChange=({target:t})=>{this.editor.state.toolState!==o.M.ToolState.ADDING&&this.clearHighlightedViews(),this.highlightView(t)},this.onSelectChange=({target:t})=>{this.setSelectedView(t)},this.onHoverChange=({target:t,previous:e})=>{if(this.editor.state.toolState===o.M.ToolState.ADDING)return;if(!t)return this.editor.clearAllDims(),this.editor.clearAllHighlights(),void(this.editor.state.selected&&this.setSelectedView(this.editor.state.selected));const i=this.data.getEntity(t);this.hoverView(i)},this.editableEntities=new r.C.EditorEntityAdapter(this.editor)}addEditableEntity(t,e){this.editableEntities.registerEntity(e,this,t)}removeEditableEntity(t){this.editableEntities.unregisterEntity(t)}activate(){0===this.readBindings.length?this.readBindings.push(this.editor.subscribe(o.M.Events.CurrentChange,this.onCurrentChange),this.editor.subscribe(o.M.Events.SelectChange,this.onSelectChange),this.editor.subscribe(o.M.Events.HoverChange,this.onHoverChange)):this.readBindings.forEach((t=>t.renew()))}deactivate(){this.readBindings.forEach((t=>t.cancel()))}clearHighlightedViews(){this.editor.clearAllHighlights()}highlightView(t){if(!t)return;const e=this.data.getEntity(t);e instanceof a.c&&this.editor.highlight(t,e.from.id,e.to.id)}setSelectedView(t){if(!t)return void this.editor.clearAllDims();const e=this.data.getEntity(t);e instanceof a.c&&this.editor.highlight(e.from.id,e.to.id),e instanceof s.JJ&&(this.clearHighlightedViews(),this.dimAllRooms(),this.selectRoom(e))}dimAllRooms(){this.editor.clearAllDims();for(const[,t]of this.data.rooms)this.dimRoom(t)}hoverView(t){t instanceof s.JJ&&this.hoverRoom(t)}hoverRoom(t){const e=t.id;this.editor.clearDim(e);for(const e of t.walls)this.editor.clearDim(e.id);for(const e of t.points)this.editor.clearDim(e.id)}selectRoom(t){const e=t.id;this.editor.clearDim(e);for(const e of t.walls)this.editor.clearDim(e.id);for(const e of t.points)this.editor.clearDim(e.id)}dimRoom(t){const e=t.id;this.editor.dim(e);for(const e of t.walls)this.editor.dim(e.id);for(const e of t.points)this.editor.dim(e.id)}}},18544:(t,e,i)=>{"use strict";i.d(e,{e:()=>o});var s=i(67992),a=i(32683);class o extends s.V{constructor(t,e,i){super(),this.data=t,this.editorState=e,this.visibleInShowcase=i,this.name="room-bound-view-data",this.roomBoundsVisible=!1}getSelectedRoom(t){if(!t)return null;const e=this.data.getEntity(t);return e instanceof a.JJ?e:null}setRoomBoundVisible(t){this.roomBoundsVisible=t,this.commit()}}},38127:(t,e,i)=>{"use strict";i.d(e,{Os:()=>o,lN:()=>r,pZ:()=>a});var s=i(19663);class a extends s.m{constructor(t){super(),this.id="roombound_unselect",this.payload={id:t}}}class o extends s.m{constructor(t=!1){super(),this.id="set_roombound_visibility",this.payload={visible:t}}}class r extends s.m{constructor(t){super(),this.id="room_bound_set_allow_rendering",this.payload={allowRendering:t}}}},6521:(t,e,i)=>{"use strict";i.d(e,{X:()=>n});var s=i(85893),a=i(84426),o=i(38399),r=i(66102);function n({room:t}){const e=(0,r.b)().t(o.Z.WORKSHOP.ROOMS.ROOM_INACCESSIBLE_INFO);return t.accessible()?null:(0,s.jsxs)("div",Object.assign({className:"room-inaccessible-container"},{children:[(0,s.jsx)(a.JO,{name:"public_symbols_exclamation-triangle",size:a.Jh.SMALL}),(0,s.jsx)("div",{children:e})]}))}},94109:(t,e,i)=>{"use strict";i.d(e,{d0:()=>u});var s=i(85893),a=i(94184),o=i.n(a),r=i(84426),n=i(56064),l=i(46391),c=i(78283),h=i(66102),d=i(62944);function u({children:t,containerClass:e,titleKey:i,measurementsInMetric:a,measurementType:u,isHideable:m,visible:g,onToggle:b}){const y=(0,n.O)(),S=(0,h.b)();let x=[];if(u===d.RV.AREA){const t=y===l.M.IMPERIAL?d.QK:d.G8;x=a.filter((t=>!isNaN(t))).map(((e,i)=>{const a=y===l.M.IMPERIAL?Math.round((0,c.Nv)(e)):Math.round(10*e)/10;return(0,s.jsx)(f,{measure:a,unit:t},i)}))}else u===d.RV.DISTANCE&&(x=a.filter((t=>!isNaN(t))).map(((t,e)=>{const i=[];if(e>0&&i.push((0,s.jsx)(v,{},`${e}_sep`)),y===l.M.IMPERIAL){const{feet:a,inches:o}=(0,c.XJ)(t);a>0?i.push((0,s.jsx)(f,{measure:a,unit:d.B5},e),(0,s.jsx)(f,{measure:o,unit:d.FP},`${e}_minor`)):i.push((0,s.jsx)(f,{measure:o,unit:d.FP},e))}else i.push((0,s.jsx)(f,{measure:t.toFixed(2),unit:d.Ep},e));return i})).flat());const E=g?"eye-show":"eye-hide",M=S.t(i);return(0,s.jsxs)("div",Object.assign({className:o()("room-detail",e)},{children:[(0,s.jsx)("div",Object.assign({className:"p5"},{children:M})),(0,s.jsxs)("div",Object.assign({className:"room-detail-info"},{children:[(0,s.jsx)(p,{measures:x,dimmed:!g}),m&&(0,s.jsx)(r.zx,{icon:E,active:!0,onClick:b})]})),t]}))}function p({measures:t,dimmed:e}){return 0===t.length?(0,s.jsx)(m,{}):(0,s.jsx)("div",Object.assign({className:("multi-pretty-measure-container "+(e?"dimmed":"")).trim()},{children:t}))}function m(){return(0,s.jsx)("div",Object.assign({className:"pretty-measure-container"},{children:(0,s.jsx)("div",Object.assign({className:"p5"},{children:"n/a"}))}))}function f({measure:t,unit:e}){return(0,s.jsxs)("div",Object.assign({className:"pretty-measure-container"},{children:[(0,s.jsx)("div",Object.assign({className:"h5 measure"},{children:t})),(0,s.jsx)("div",Object.assign({className:"p5 unit"},{children:e}))]}))}function v(){return(0,s.jsx)("div",Object.assign({className:"p5 separator"},{children:d.RQ}))}},29300:(t,e,i)=>{"use strict";i.d(e,{Vr:()=>l,Ah:()=>h,tL:()=>c});var s=i(85893),a=i(38399),o=i(66102),r=i(94184),n=i.n(r);function l({room:t}){return(0,s.jsx)(d,{warningKey:a.Z.WORKSHOP.ROOMS.ROOM_MISSING_DIMENSIONS,missing:!t.canDisplayDimensions()})}function c({room:t}){return(0,s.jsx)(d,{warningKey:a.Z.WORKSHOP.ROOMS.ROOM_MISSING_HEIGHT,missing:!t.canDisplayHeight()})}function h({room:t}){return(0,s.jsx)(d,{warningKey:a.Z.WORKSHOP.ROOMS.ROOM_MISSING_INFO,missing:!t.canDisplayDimensions()||!t.canDisplayHeight()})}function d({missing:t,warningKey:e}){const i=(0,o.b)().t(e);return t?(0,s.jsx)("div",Object.assign({className:n()("room-missing-info-warning","room-detail-child-container")},{children:i})):null}},37749:(t,e,i)=>{"use strict";i.d(e,{M:()=>c});var s=i(85893),a=i(66102),o=i(38399),r=i(94109),n=i(62944),l=i(29300);function c({room:t}){const e=(0,a.b)().t(o.Z.SHOWCASE.ROOMS.ROOM_INFORMATION);return(0,s.jsxs)("div",Object.assign({className:"room-size-info"},{children:[(0,s.jsx)("div",Object.assign({className:"room-info-title"},{children:e})),(0,s.jsxs)("div",Object.assign({className:"room-info-detail-container"},{children:[(0,s.jsx)(r.d0,{titleKey:o.Z.SHOWCASE.ROOMS.ROOM_AREA,measurementsInMetric:[t.area],measurementType:n.RV.AREA,isHideable:!1,visible:!0}),(0,s.jsx)(r.d0,{titleKey:o.Z.SHOWCASE.ROOMS.ROOM_DIMENSIONS,measurementsInMetric:t.canDisplayDimensions()?[t.width,t.length]:[],measurementType:n.RV.DISTANCE,isHideable:!1,visible:!0}),(0,s.jsx)(r.d0,{titleKey:o.Z.SHOWCASE.ROOMS.ROOM_HEIGHT,measurementsInMetric:t.canDisplayHeight()?[t.height]:[],measurementType:n.RV.DISTANCE,isHideable:!1,visible:!0}),(0,s.jsx)(r.d0,{titleKey:o.Z.SHOWCASE.ROOMS.ROOM_PERIMETER,measurementsInMetric:[t.perimeter],measurementType:n.RV.DISTANCE,isHideable:!1,visible:!0}),(0,s.jsx)(l.Ah,{room:t})]}))]}))}},91153:(t,e,i)=>{"use strict";i.d(e,{n:()=>h});var s=i(1358),a=i(38613),o=i(45755),r=i(18544);const n=(0,o.u)(r.e);function l(){const t=function(){const t=n();return(null==t?void 0:t.editorState)||null}();return(0,a.h)(t,"selected",null)}var c=i(32683);function h(){const t=function(){const t=(0,s.S)(),e=l();return e&&t?t.getEntity(e):null}();return t&&t instanceof c.JJ?t:null}},62689:(t,e,i)=>{"use strict";i.d(e,{v:()=>s});const s=[{outerRadius:1,innerRadius:.97,color:0,opacity:.1},{outerRadius:.97,innerRadius:.65,color:16777215,opacity:.64},{outerRadius:.65,innerRadius:.62,color:0,opacity:.13}]},55248:(t,e,i)=>{"use strict";i.d(e,{C:()=>s});var s,a=i(10513);!function(t){const e={[a.M.Events.HoverChange.type]:"hoverState",[a.M.Events.SelectChange.type]:"selectState",[a.M.Events.ValidChange.type]:"validState",[a.M.Events.Move.type]:"mover",[a.M.Events.HighlightAdd.type]:"highlightState",[a.M.Events.HighlightClear.type]:"highlightState",[a.M.Events.DimAdd.type]:"dimState",[a.M.Events.DimClear.type]:"dimState"};t.EditorEntityAdapter=class{constructor(t){this.editor=t,this.bindings=[],this.entities=new Map,this.bindings.push(this.editor.subscribe(a.M.Events.HoverChange,(t=>this.bindTargetedCallback(a.M.Events.HoverChange.type,t))),this.editor.subscribe(a.M.Events.SelectChange,(t=>this.bindTargetedCallback(a.M.Events.SelectChange.type,t))),this.editor.subscribe(a.M.Events.ValidChange,(t=>this.bindTargetedCallback(a.M.Events.ValidChange.type,t))),this.editor.subscribe(a.M.Events.HighlightAdd,(t=>this.bindTargetedCallback(a.M.Events.HighlightAdd.type,t))),this.editor.subscribe(a.M.Events.HighlightClear,(t=>this.bindClearCallback(a.M.Events.HighlightClear.type,t))),this.editor.subscribe(a.M.Events.DimAdd,(t=>this.bindTargetedCallback(a.M.Events.DimAdd.type,t))),this.editor.subscribe(a.M.Events.DimClear,(t=>this.bindClearCallback(a.M.Events.DimClear.type,t))),this.editor.subscribe(a.M.Events.Move,(t=>this.bindMoveCallback(t))))}registerEntity(t,...e){let i=this.entities.get(t);i||(i=[]),i.push(...e),this.entities.set(t,i)}unregisterEntity(t){return this.entities.delete(t)}bindTargetedCallback(t,i){let s=null,o=null;a.M.Events.hasTargetAndPrev(i)?(s=i.target,o=i.previous):a.M.Events.hasTarget(i)&&(s=i.target);const r=e[t];if(!r)throw Error(`implement targetted callback for ${t}`);(this.entities.get(o)||[]).forEach((t=>{r in t&&(t[r].active=!1,t[r].off())})),(this.entities.get(s)||[]).forEach((t=>{r in t&&(t[r].active=!0,t[r].on())}))}bindMoveCallback(t){(this.entities.get(t.target)||[]).forEach((e=>{e.mover&&t.target&&e.mover.onMove(t.target,t.ev)}))}bindClearCallback(t,i){let s=null;const o=e[t];a.M.Events.hasTarget(i)&&(s=i.target),(this.entities.get(s)||[]).forEach((t=>{o in t&&(t[o].active=!1,t[o].off())}))}}}(s||(s={}))},67971:(t,e,i)=>{"use strict";i.d(e,{$7:()=>h,uc:()=>u,N3:()=>c});var s=i(81396),a=i(4679),o=i(59370),r=i(69505),n=i(49827),l=i(67944);var c;(0,a.Dy)({unicodeFontsURL:"https://static.matterport.com/webgl-vendors/unicode-font-resolver/1.0.1/"}),function(t){t.WORLD="world",t.NDC="ndc"}(c||(c={}));class h extends s.Object3D{constructor(t,e=c.WORLD){var i,o,r,n;super(),this.config=t,this.scaleType=e,this.unscaledWidth=0,this.unscaledHeight=0,this.labelTextMaterial=new s.MeshBasicMaterial,this.bindings=[];const l=this.config.background||this.config.backgroundAsCollider;if(l){this.config.backgroundOpacity=void 0!==this.config.backgroundOpacity?this.config.backgroundOpacity:1,this.config.backgroundOpacity=this.config.background?this.config.backgroundOpacity:0;const e=new s.BoxGeometry(1,1,.01),i=new s.MeshBasicMaterial({color:t.backgroundColor,transparent:!0,depthTest:this.config.backgroundOpacity>0&&!t.disableDepth,depthWrite:this.config.backgroundOpacity>0&&!t.disableDepth,opacity:this.config.backgroundOpacity,stencilRef:1,stencilFail:s.KeepStencilOp,stencilZFail:s.KeepStencilOp,stencilZPass:s.ReplaceStencilOp,stencilFunc:s.AlwaysStencilFunc,stencilWrite:!0});this.labelBackgroundMesh=new this.config.backgroundColliderType(e,i),this.labelBackgroundMesh.position.z=-.01,this.labelBackgroundMesh.name="Label Background",this.collider=this.labelBackgroundMesh,this.add(this.labelBackgroundMesh)}const h=this.labelTextMesh=new a.xv;h.material=this.labelTextMaterial,h.name="Label Text",h.text=t.text||"",h.renderOrder=10,h.font=`${null!==(i=t.assetBasePath)&&void 0!==i?i:""}${t.fontPath}`,h.lang=t.lang,h.fontSize=1,h.fontWeight=700,h.anchorX="50%",h.anchorY="50%",h.outlineWidth=t.outline?t.outlineWidth:0,h.maxWidth=t.wordWrapWidth,h.textAlign=t.align,h.depthOffset=t.depthOffset||0,l&&(h.raycast=()=>{}),h.addEventListener("synccomplete",(()=>{var t;const[e,i,s,a]=h.textRenderInfo.visibleBounds;let o=s-e,r=a-i;l&&(o+=this.config.backgroundBorderWidth,r+=this.config.backgroundBorderHeight,this.labelBackgroundMesh.scale.set(o,r,1)),this.unscaledWidth=o,this.unscaledHeight=r,this.aspect=o/Math.max(r,.001),h.position.set((e+s)/-2,(i+a)/-2,0),null===(t=this._onGeomUpdate)||void 0===t||t.call(this)})),this.scaleFactor=null!==(o=t.scale)&&void 0!==o?o:1,this.opacity=null!==(r=t.opacity)&&void 0!==r?r:1,this.setColor(null!==(n=t.color)&&void 0!==n?n:0),this.add(h),h.sync(),this.name="Label Container"}dispose(){this.bindings.forEach((t=>t.cancel())),this.labelTextMesh.dispose()}onGeomUpdate(t){this._onGeomUpdate=t}get text(){return this.config.text}set text(t){this.config.text=t,this.labelTextMesh.text=t,this.labelTextMesh.sync()}get mesh(){return this.labelTextMesh}getUnscaledSize(){return{width:this.unscaledWidth,height:this.unscaledHeight}}get scaleFactor(){return this.config.scale}set scaleFactor(t){this.config.scale=t,this.scale.setScalar(t)}get opacity(){return void 0!==this.config.opacity?this.config.opacity:1}set opacity(t){if(t!==this.config.opacity){this.config.opacity=t;const e=t>0&&!this.config.disableDepth;if(this.config.background){const i=this.labelBackgroundMesh.material;i.opacity=Math.min(this.config.backgroundOpacity||1,t),i.depthWrite=t>.15,i.depthTest=e}const i=this.labelTextMaterial;i.opacity=t,i.depthTest=e,this.visible=t>0}}setColor(t){this.labelTextMaterial.color.set(t)}setRenderLayer(t){this.labelTextMesh.layers.mask=t.mask,this.labelBackgroundMesh&&(this.labelBackgroundMesh.layers.mask=t.mask)}setRenderOrder(t){this.renderOrder=t,this.labelTextMesh.renderOrder=t,this.labelBackgroundMesh&&(this.labelBackgroundMesh.renderOrder=t)}setPosition(t,e=(t=>t)){this.position.copy(e(t))}setOrientation(t,e=0){this.quaternion.copy(t),0!==e&&this.rotateZ(-e*r.Ue)}scaleBillboard(t,e,i,s,a,r,h=d.SCALE_DEFAULT){if(0!==i.elements[15])this.scaleFactor=.2*h*s*(d.ORTHO_IDEAL_HEIGHT/a);else{const u=(0,o.D_)(this.position,t,e,i.asThreeMatrix4()),p=Math.abs(u.x);if(p<1){const e=(0,l.mY)(i,t,this.position,a,h),o=((0,n.uZ)(r,1,2.5)+s)*d.SCALE_ASPECT,u=1+d.SCALE_NDC-p*d.SCALE_NDC-o,m=Math.max(Math.min(1/e*u,3),.001);this.scaleType===c.NDC?this.scaleFactor=m:this.scaleFactor=Math.min(m*d.NDC_MULT,h*d.SCALE_WORLD)}else this.scaleFactor=.001}}}const d={SCALE_DEFAULT:.1,SCALE_WORLD:4,SCALE_NDC:.5,SCALE_ASPECT:.035,DEPTH_WRITE_THRESHOD:.15,ORTHO_IDEAL_HEIGHT:1500,NDC_MULT:1.15};class u{constructor(t){this.currentTextConfig=u.defaultTextConfig,t?this.updateTextStyle(t):this.updateTextStyle(u.defaultTextConfig)}updateTextStyle(t){this.currentTextConfig=Object.assign(Object.assign({},this.currentTextConfig),t)}createLabel(t={text:""}){return new h(Object.assign(Object.assign({},this.currentTextConfig),t))}async preload(t={text:""}){const e=Object.assign(Object.assign({},this.currentTextConfig),t);return new Promise((t=>{var i;(0,a.C5)({font:`${null!==(i=e.assetBasePath)&&void 0!==i?i:""}${e.fontPath}`,characters:e.text},t)}))}static makeConfig(t){return Object.assign(Object.assign({},u.defaultTextConfig),t)}}u.defaultTextConfig={text:"",fontPath:"fonts/roboto-700.woff",align:"center",wordWrapWidth:void 0,color:"black",backgroundColor:"white",backgroundBorderWidth:.9,backgroundBorderHeight:.7,background:!0,backgroundAsCollider:!0,backgroundColliderType:s.Mesh,scale:1,outline:!1,outlineWidth:.06}},73868:t=>{t.exports="precision highp float;uniform float paddingPx;uniform float aaPaddingPx;uniform vec3 color;uniform float opacity;varying vec2 vOffsetPx;uniform float outline;uniform vec3 outlineColor;varying vec2 scaledWidthHeightPx;float sdTriangle(vec2 p,vec2 p0,vec2 p1,vec2 p2){vec2 e0=p1-p0;vec2 e1=p2-p1;vec2 e2=p0-p2;vec2 v0=p-p0;vec2 v1=p-p1;vec2 v2=p-p2;vec2 pq0=v0-e0*clamp(dot(v0,e0)/dot(e0,e0),0.,1.);vec2 pq1=v1-e1*clamp(dot(v1,e1)/dot(e1,e1),0.,1.);vec2 pq2=v2-e2*clamp(dot(v2,e2)/dot(e2,e2),0.,1.);float s=e0.x*e2.y-e0.y*e2.x;vec2 d=min(min(vec2(dot(pq0,pq0),s*(v0.x*e0.y-v0.y*e0.x)),vec2(dot(pq1,pq1),s*(v1.x*e1.y-v1.y*e1.x))),vec2(dot(pq2,pq2),s*(v2.x*e2.y-v2.y*e2.x)));return-sqrt(d.x)*sign(d.y);}void main(){float padding=aaPaddingPx+outline;float halfWidth=scaledWidthHeightPx.x/2.;vec2 p0=vec2(-halfWidth,scaledWidthHeightPx.y+padding);vec2 p1=vec2(halfWidth,scaledWidthHeightPx.y+padding);vec2 p2=vec2(0.,padding);float sd=sdTriangle(vOffsetPx,p0,p1,p2);float aaOpacity=1.-smoothstep(outline,outline+0.5,sd);float colorMix=smoothstep(0.,outline,sd);vec3 colorWithOutline=mix(color,outlineColor,colorMix);gl_FragColor=vec4(colorWithOutline,aaOpacity*opacity);}"},25888:t=>{t.exports="precision highp float;uniform vec2 screenSize;vec2 rotate90(vec2 v){return vec2(-v.y,v.x);}vec2 ndcToScreen(vec4 pt){return pt.xy*screenSize/2.;}vec2 screenToNdc(vec2 pt){return pt*2./screenSize;}\n#define MIN_SCALE  0.4\n#define MIN_METERS_PER_PX  0.006\n#define MAX_METERS_PER_PX  0.012\nuniform float paddingPx;uniform float widthPx;uniform float heightPx;uniform float aaPaddingPx;uniform float metersPerPx;uniform float outline;uniform vec2 tip;uniform vec2 normal;uniform float height;attribute vec2 offset;uniform mat4 projectionMatrix;uniform mat4 modelViewMatrix;varying vec2 vOffsetPx;varying vec2 scaledWidthHeightPx;vec2 scaleByZoom(){float t=clamp((metersPerPx-MIN_METERS_PER_PX)/(MAX_METERS_PER_PX-MIN_METERS_PER_PX),0.,1.);float scale=mix(1.,MIN_SCALE,t);return vec2(widthPx,heightPx)*scale;}void main(){vec2 yAxis=normal;vec2 xAxis=rotate90(yAxis);vec4 tipWorld=vec4(tip.x,height,tip.y,1.);vec4 xOffsetWorld=tipWorld+vec4(xAxis.x,0.,xAxis.y,0.);vec4 yOffsetWorld=tipWorld+vec4(yAxis.x,0.,yAxis.y,0.);vec4 ndcTip=projectionMatrix*modelViewMatrix*tipWorld;vec2 tipScreen=ndcToScreen(ndcTip/ndcTip.w);vec4 ndcXOffset=projectionMatrix*modelViewMatrix*xOffsetWorld;vec2 xOffsetScreen=ndcToScreen(ndcXOffset/ndcXOffset.w);vec4 ndcYOffset=projectionMatrix*modelViewMatrix*yOffsetWorld;vec2 yOffsetScreen=ndcToScreen(ndcYOffset/ndcYOffset.w);vec2 xAxisScreen=normalize(xOffsetScreen-tipScreen);vec2 yAxisScreen=normalize(yOffsetScreen-tipScreen);float padding=aaPaddingPx+outline;scaledWidthHeightPx=scaleByZoom();float halfWidth=scaledWidthHeightPx.x/2.+padding;float quadHeight=scaledWidthHeightPx.y+padding*2.;vec2 vertexScreen=(tipScreen+yAxisScreen*paddingPx)+xAxisScreen*halfWidth*offset.x+yAxisScreen*quadHeight*offset.y;vec2 ndcVert=screenToNdc(vertexScreen);vOffsetPx=vec2(offset.x*halfWidth,offset.y*quadHeight);gl_Position=vec4(ndcVert*ndcTip.w,ndcTip.z,ndcTip.w);}"},72292:t=>{t.exports="precision highp float;uniform float opacity;uniform float centerSpacing;uniform float radius;uniform vec3 color;void main(){vec2 center=mod(gl_FragCoord.xy,vec2(centerSpacing))-vec2(centerSpacing*0.5);float polkaDot=1.-smoothstep(radius-(radius*0.2),radius,length(center));gl_FragColor=vec4(color,opacity*polkaDot);}"},47706:t=>{t.exports="precision highp float;uniform mat4 projectionMatrix;uniform mat4 modelViewMatrix;attribute vec3 position;void main(){gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.);}"},73293:t=>{t.exports="#define ANTIALIAS_WIDTH  1.0\nprecision highp float;uniform vec3 outlineColor;uniform vec3 baseColor;uniform float radius;uniform float opacity;uniform float outlinePct;varying vec3 vPosition;void main(){float fragRadius=length(vPosition.xz);float outlineRadius=radius*outlinePct;float smoothAmt=fwidth(fragRadius)*ANTIALIAS_WIDTH;float mixAmt=smoothstep(outlineRadius-smoothAmt,outlineRadius,fragRadius);gl_FragColor=vec4(mix(baseColor,outlineColor,mixAmt),1.);gl_FragColor.a=opacity*(1.-smoothstep(radius-smoothAmt,radius,fragRadius));}"},67498:t=>{t.exports="precision highp float;uniform mat4 projectionMatrix;uniform mat4 modelViewMatrix;attribute vec3 position;varying vec3 vPosition;void main(){vPosition=position;gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.);}"},14536:t=>{t.exports="precision highp float;uniform vec3 baseColor;uniform float isDoor;varying vec3 vPosition;void main(){const float lineWidth=0.15;if(isDoor>0.){const float startZ=0.15;const float endZ=startZ+lineWidth;float alpha=(abs(vPosition.z)>startZ&&abs(vPosition.z)<endZ)?1.:0.;gl_FragColor=vec4(baseColor,alpha);}else{float alpha=(abs(vPosition.z)<lineWidth*0.5)?1.:0.;gl_FragColor=vec4(baseColor,alpha);}}"},86242:t=>{t.exports="precision highp float;uniform mat4 projectionMatrix;uniform mat4 modelViewMatrix;attribute vec3 position;varying vec3 vPosition;void main(){vPosition=position;gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.);}"},93670:t=>{t.exports="#define ANTIALIAS_WIDTH  1.0\nprecision highp float;uniform float selectedWidth;uniform vec3 outlineColor;uniform vec3 color;uniform float opacity;uniform float width;uniform vec3 lineStart;uniform vec3 lineEnd;varying vec3 vWorldPos;float distanceBetween(vec2 l1,vec2 l2,vec2 p){float D=length(l2-l1);float N=abs((l2.x-l1.x)*(l1.y-p.y)-(l1.x-p.x)*(l2.y-l1.y));return N/D;}void main(){float distanceToLine=distanceBetween(lineStart.xz,lineEnd.xz,vWorldPos.xz);float aaWidth=fwidth(distanceToLine)*ANTIALIAS_WIDTH;float lineLerp=smoothstep(selectedWidth-aaWidth,selectedWidth,distanceToLine);float halfWidth=width*0.5;float aaOpacity=smoothstep(halfWidth,halfWidth-aaWidth,distanceToLine);gl_FragColor=mix(vec4(outlineColor,opacity*aaOpacity),vec4(color,opacity*aaOpacity),lineLerp);if(gl_FragColor.a<0.01){discard;}}"},40134:t=>{t.exports="precision highp float;uniform mat4 projectionMatrix;uniform mat4 modelViewMatrix;attribute vec3 position;varying vec3 vWorldPos;void main(){vWorldPos=position;gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.);}"}}]);